{"openapi":"3.0.3","info":{"title":"Chat service API","description":"","termsOfService":"","contact":{"name":"","url":"","email":""},"license":{"name":"","url":""},"version":""},"servers":[{"url":"/","description":"USE THIS SERVER IF YOU OPEN THIS PAGE DIRECTLY"},{"url":"/chat-service","description":"USE THIS SERVER IF YOU OPEN THIS BEHIND GATEWAY"}],"security":[{"User JWT Token":[],"Basic auth":[]}],"tags":[{"name":"Chat service","description":"Chat service API"}],"paths":{"/api/external/chats":{"get":{"tags":["Chat service"],"summary":"get chat by page","description":"get chat by page","operationId":"getByPage","parameters":[{"name":"paginationRequest.num","in":"query","description":"Page number","required":false,"schema":{"minimum":1,"type":"integer","description":"Page number","format":"int32","example":1},"example":1},{"name":"paginationRequest.size","in":"query","description":"Page size","required":false,"schema":{"minimum":1,"type":"integer","description":"Page size","format":"int32","example":10},"example":10},{"name":"type","in":"query","required":false,"schema":{"type":"string","enum":["SUPPORT","ITEM","ORDER","RFQ"]}},{"name":"profileId","in":"query","required":false,"schema":{"type":"integer","format":"int64"}},{"name":"profileType","in":"query","required":false,"schema":{"type":"string","enum":["COMMON_BUYER","COMMON_SELLER","LEGAL_BUYER","LEGAL_SELLER","OPERATOR","COMMON_AGENT","LEGAL_AGENT","UNKNOWN","MODERATOR","TECHNICAL_USER","COURIER"]}},{"name":"messageLimit","in":"query","required":false,"schema":{"minimum":0,"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultPageChatPaginationShared"}}}}}},"post":{"tags":["Chat service"],"summary":"Create chat","description":"Create chat by request","operationId":"createChat","parameters":[{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultLong"}}}}}}},"/api/external/chats/{id}/members":{"post":{"tags":["Chat service"],"summary":"Add chat member","description":"Add chat member to chat by id","operationId":"addChatMember","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"integer","format":"int64"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultBoolean"}}}}}}},"/api/external/chats/attachments":{"post":{"tags":["Chat service"],"summary":"Upload attachment to chat","operationId":"uploadAttachment","parameters":[{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"requestBody":{"content":{"multipart/form-data":{"schema":{"required":["file"],"type":"object","properties":{"file":{"type":"string","description":"Attachment","format":"binary"}}}}}},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultFileAttachment"}}}}}}},"/api/external/chats/{id}":{"get":{"tags":["Chat service"],"summary":"get chat by id","description":"get chat by id","operationId":"getById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"profileId","in":"query","required":false,"schema":{"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultChatShared"}}}}}}},"/api/external/chats/{id}/messages":{"get":{"tags":["Chat service"],"summary":"Get messages","description":"Get messages by page","operationId":"getMessagesByPage","parameters":[{"name":"paginationRequest.num","in":"query","description":"Page number","required":false,"schema":{"minimum":1,"type":"integer","description":"Page number","format":"int32","example":1},"example":1},{"name":"paginationRequest.size","in":"query","description":"Page size","required":false,"schema":{"minimum":1,"type":"integer","description":"Page size","format":"int32","example":10},"example":10},{"name":"chatId","in":"query","required":false,"schema":{"minimum":1,"type":"integer","format":"int64"}},{"name":"userId","in":"query","required":false,"schema":{"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultPageMessageShared"}}}}}}},"/api/external/chats/summary":{"get":{"tags":["Chat service"],"summary":"Get summary by chats","description":"Get summary response by chat which contains info about\nunread messages and meta info about chat. Response is map where key is chat id","operationId":"chatSummaryByUser","parameters":[{"name":"profileId","in":"query","required":false,"schema":{"minimum":1,"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultChatSummaryResponse"}}}}}}},"/api/external/chats/{id}/leave":{"delete":{"tags":["Chat service"],"summary":"leave chat","description":"Leave chat. User should be authorized","operationId":"leaveChat","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"in":"header","$ref":"#/components/parameters/requestLanguage"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ActionResultBoolean"}}}}}}}},"components":{"schemas":{"ChatCreateRequest":{"required":["title","type"],"type":"object","properties":{"title":{"type":"string"},"type":{"type":"string","enum":["SUPPORT","ITEM","ORDER","RFQ"]},"entityId":{"type":"integer","format":"int64"},"creatorProfileId":{"type":"integer","format":"int64"},"creatorProfileType":{"type":"string","enum":["COMMON_BUYER","COMMON_SELLER","LEGAL_BUYER","LEGAL_SELLER","OPERATOR","COMMON_AGENT","LEGAL_AGENT","UNKNOWN","MODERATOR","TECHNICAL_USER","COURIER"]},"opponentProfileId":{"type":"integer","format":"int64"},"opponentIsLegal":{"type":"boolean"}}},"ActionResultLong":{"type":"object","properties":{"value":{"title":"Response main value","type":"integer","format":"int64"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"ActionResultBoolean":{"type":"object","properties":{"value":{"title":"Response main value","type":"boolean"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"ActionResultFileAttachment":{"type":"object","properties":{"value":{"$ref":"#/components/schemas/FileAttachment"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"FileAttachment":{"title":"Response main value","type":"object","properties":{"name":{"type":"string"},"relativeUrl":{"type":"string"},"metadata":{"$ref":"#/components/schemas/Metadata"}}},"Metadata":{"type":"object","properties":{"fileSize":{"type":"integer","format":"int64"},"createdAt":{"type":"string","format":"date-time"},"mimeType":{"type":"string"}}},"ActionResultPageChatPaginationShared":{"type":"object","properties":{"value":{"$ref":"#/components/schemas/PageChatPaginationShared"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"ChatMemberShared":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"profileId":{"type":"integer","format":"int64"},"fullName":{"type":"string"},"profileType":{"type":"string","enum":["COMMON_BUYER","COMMON_SELLER","LEGAL_BUYER","LEGAL_SELLER","OPERATOR","COMMON_AGENT","LEGAL_AGENT","UNKNOWN","MODERATOR","TECHNICAL_USER","COURIER"]},"kicked":{"type":"boolean"},"chatId":{"type":"integer","format":"int64"}}},"ChatPaginationShared":{"title":"Data","type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"type":{"type":"string","enum":["SUPPORT","ITEM","ORDER","RFQ"]},"lastMessage":{"$ref":"#/components/schemas/MessageShared"},"chatMembers":{"type":"array","items":{"$ref":"#/components/schemas/ChatMemberShared"}}}},"MessageShared":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"creator":{"$ref":"#/components/schemas/ChatMemberShared"},"messageText":{"type":"string"},"guid":{"type":"string"},"attachments":{"type":"array","items":{"$ref":"#/components/schemas/FileAttachment"}},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"PageChatPaginationShared":{"title":"Response main value","type":"object","properties":{"data":{"title":"Data","type":"array","items":{"$ref":"#/components/schemas/ChatPaginationShared"}},"totalCount":{"title":"total count","type":"integer","format":"int64"},"currentPage":{"title":"Requested current page","type":"integer","format":"int32"}}},"ActionResultChatShared":{"type":"object","properties":{"value":{"$ref":"#/components/schemas/ChatShared"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"ChatShared":{"title":"Response main value","type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"type":{"type":"string","enum":["SUPPORT","ITEM","ORDER","RFQ"]},"messages":{"type":"array","items":{"$ref":"#/components/schemas/MessageShared"}},"unreadMessages":{"type":"array","items":{"$ref":"#/components/schemas/MessageShared"}}}},"ActionResultPageMessageShared":{"type":"object","properties":{"value":{"$ref":"#/components/schemas/PageMessageShared"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"PageMessageShared":{"title":"Response main value","type":"object","properties":{"data":{"title":"Data","type":"array","items":{"$ref":"#/components/schemas/MessageShared"}},"totalCount":{"title":"total count","type":"integer","format":"int64"},"currentPage":{"title":"Requested current page","type":"integer","format":"int32"}}},"ActionResultChatSummaryResponse":{"type":"object","properties":{"value":{"$ref":"#/components/schemas/ChatSummaryResponse"},"success":{"title":"Success or not","type":"boolean"},"service":{"title":"Response from microservice","type":"string","enum":["FILTER","ARTICLE","CONTENT","CART","CMS","DICTIONARY","ITEM","NOTIFICATION","ORDER","PAYMENT","REVIEW","USER","WEB","WEB_API","FISCALIZATION","LOGISTICS","RSHB_INTEGRATION","MAKER_CHECKER","UNDEFINED","EVENT_LOG","REPORT","EXTERNAL_FEED","SEARCH","EASWAAQ","INTEGRATION","CHAT"]},"errorCode":{"title":"Error code","type":"string"},"message":{"title":"Detailed description of error","type":"string"},"errorValue":{"title":"Error value if present","type":"object"},"targetUrl":{"title":"Target URL for redirect after response","type":"string"}}},"ChatInfoByUserShared":{"type":"object","properties":{"unreadMessages":{"type":"integer","format":"int32"},"chatTitle":{"type":"string"},"chatType":{"type":"string","enum":["SUPPORT","ITEM","ORDER","RFQ"]},"lastMessage":{"$ref":"#/components/schemas/MessageShared"},"chatMembers":{"type":"array","items":{"$ref":"#/components/schemas/ChatMemberShared"}}}},"ChatSummaryResponse":{"title":"Response main value","type":"object","properties":{"chatId2ChatInfo":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/ChatInfoByUserShared"}},"chatType2totalUnreadMessages":{"type":"object","additionalProperties":{"type":"integer","format":"int64"}}}}},"parameters":{"requestLanguage":{"name":"Request-Language","in":"header","description":"Available languages for request: ru, en, hi, fr, ar, kh, cn","schema":{"type":"string"},"example":"ru"}},"securitySchemes":{"User JWT Token":{"type":"http","scheme":"bearer","bearerFormat":"JWT"},"Basic auth":{"type":"http","scheme":"basic"}}}}
